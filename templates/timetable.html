{% extends "base.html" %}

{% block title %}–®–∞–±–ª–æ–Ω —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', path='css/templates.css') }}">
{% endblock %}

{% block content %}
<h1>üìÖ –®–∞–±–ª–æ–Ω —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</h1>

<div class="templates-container">
    <button class="generate-btn" onclick="generateLessons()">
        üîÑ –°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫–∏ –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏ –≤–ø–µ—Ä–µ–¥ –∏–∑ —à–∞–±–ª–æ–Ω–∞
    </button>

    {% for day_index in range(7) %}
    <div class="day-section" data-day="{{ day_index }}">
        <div class="day-title">{{ weekdays[day_index] }}</div>

        <div class="templates-list" id="templates-{{ day_index }}">
            {% for template in templates if template.day_of_week == day_index %}
            <div class="template-lesson" data-template-id="{{ template.id }}">
                <div class="lesson-number">{{ template.lesson_number }}.</div>
                <div class="lesson-subject">{{ template.subject.name }}</div>
                <div class="lesson-time">
                    {% if template.start_time %}
                    {{ template.start_time }}{% if template.end_time %} - {{ template.end_time }}{% endif %}
                    {% else %}
                    –í—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ
                    {% endif %}
                </div>
                <div class="lesson-actions">
                    <button onclick="editTemplate({{ template.id }})">‚úèÔ∏è</button>
                    <button onclick="deleteTemplate({{ template.id }})">üóëÔ∏è</button>
                </div>
            </div>
            {% endfor %}
        </div>

        <button class="add-lesson-btn" onclick="showAddTemplateModal({{ day_index }})">
            + –î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫ –≤ {{ weekdays[day_index]|lower }}
        </button>
    </div>
    {% endfor %}
</div>

<div id="templateModal" class="modal">
    <div class="modal-content">
        <h2 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫ –≤ —à–∞–±–ª–æ–Ω</h2>
        <form id="templateForm">
            <input type="hidden" id="templateId" name="templateId">
            <input type="hidden" id="templateDay" name="day_of_week">

            <div class="form-group">
                <label for="templateSubject">–ü—Ä–µ–¥–º–µ—Ç *</label>
                <select id="templateSubject" name="subject_id" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</option>
                    {% for subject in subjects %}
                    <option value="{{ subject.id }}">{{ subject.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="templateLessonNumber">–ù–æ–º–µ—Ä —É—Ä–æ–∫–∞ *</label>
                <input type="number" id="templateLessonNumber" name="lesson_number" min="1" max="8" required>
            </div>

            <div class="form-group">
                <label for="templateStartTime">–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞</label>
                <input type="time" id="templateStartTime" name="start_time">
            </div>

            <div class="form-group">
                <label for="templateEndTime">–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
                <input type="time" id="templateEndTime" name="end_time">
            </div>

            <div class="form-group">
                <label for="templateRoom">–ö–∞–±–∏–Ω–µ—Ç</label>
                <input type="text" id="templateRoom" name="room">
            </div>

            <div class="modal-buttons">
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </form>
    </div>
</div>

<script src="{{ url_for('static', path='js/add_lesson.js') }}"></script>
{% endblock %}